# 英语教育系统 v4.1 - 排课管理开发计划

## 🎯 v4.1 版本目标

在v4.0基础上，新增排课管理和考勤管理功能，形成完整的教学管理闭环，为家长端H5提供完整的课程和学习数据支撑。

## 📊 当前状态 (2025-08-18)

### ✅ 已完成基础功能
- [x] 学员管理系统 (学员信息、状态管理、资源转换)
- [x] 班级管理系统 (班级创建、学员分班)
- [x] 课程管理系统 (课程体系、级别单元)
- [x] 用户权限系统 (角色权限、菜单权限)
- [x] 组织架构管理 (机构、校区、部门)

### ✅ 已完成设计
- [x] v4.1 PRD文档 (`docs/product-versions/v4.1-schedule-attendance-system.md`)
- [x] 数据库表结构设计
- [x] 业务流程设计
- [x] 界面功能设计

## 🚀 v4.1 开发任务

### 阶段1：数据库建设 (3-5天) 🔄 进行中

#### 1.1 时间段配置表 (time_slots)
- [ ] 创建迁移文件
- [ ] 创建模型文件
- [ ] 创建种子数据
- [ ] 测试数据验证

#### 1.2 课程安排表 (class_schedules)  
- [ ] 创建迁移文件
- [ ] 创建模型文件
- [ ] 设置外键关系
- [ ] 添加唯一约束

#### 1.3 考勤记录表 (attendance_records)
- [ ] 创建迁移文件
- [ ] 创建模型文件
- [ ] 设置关联关系
- [ ] 添加索引优化

#### 1.4 实际上课记录表 (actual_lesson_records)
- [ ] 创建迁移文件
- [ ] 创建模型文件
- [ ] 设置计算字段
- [ ] 添加业务约束

#### 1.5 补课安排表 (makeup_schedules)
- [ ] 创建迁移文件
- [ ] 创建模型文件
- [ ] 设置关联关系
- [ ] 添加状态管理

### 阶段2：排课功能开发 (5-7天)

#### 2.1 时间段管理
- [ ] TimeSlotController API
  - [ ] 列表查询 (index)
  - [ ] 创建时间段 (store)
  - [ ] 更新时间段 (update)
  - [ ] 删除时间段 (destroy)
- [ ] TimeSlot 模型和关系
- [ ] TimeSlotResource 资源转换
- [ ] 时间段管理前端界面

#### 2.2 一键排课功能
- [ ] ClassScheduleController API
  - [ ] 批量排课 (batchStore)
  - [ ] 排课列表 (index)
  - [ ] 排课详情 (show)
  - [ ] 更新排课 (update)
  - [ ] 取消排课 (destroy)
- [ ] 排课冲突检测逻辑
  - [ ] 教师时间冲突检测
  - [ ] 教室占用冲突检测
  - [ ] 班级时间冲突检测
- [ ] 排课前端界面
  - [ ] 班级选择组件
  - [ ] 日历多选组件
  - [ ] 时间段选择组件
  - [ ] 教师选择组件
  - [ ] 批量排课弹窗

#### 2.3 课程表查看
- [ ] 课程表查询API
  - [ ] 班级课表 (getClassSchedule)
  - [ ] 教师课表 (getTeacherSchedule)
  - [ ] 日程总览 (getOverallSchedule)
- [ ] 课程表前端界面
  - [ ] 周视图组件
  - [ ] 月视图组件
  - [ ] 筛选功能
  - [ ] 导出功能

### 阶段3：考勤功能开发 (5-7天)

#### 3.1 今日课程管理
- [ ] 今日课程查询API
  - [ ] 获取今日课程列表
  - [ ] 按教师筛选
  - [ ] 按班级筛选
  - [ ] 课程状态统计
- [ ] 今日课程前端界面
  - [ ] 课程列表展示
  - [ ] 快速操作按钮
  - [ ] 状态标识

#### 3.2 点名签到功能
- [ ] AttendanceController API
  - [ ] 获取班级学员列表
  - [ ] 批量点名签到 (batchAttendance)
  - [ ] 更新出勤状态 (updateAttendance)
  - [ ] 考勤统计 (getAttendanceStats)
- [ ] 点名前端界面
  - [ ] 学员列表组件
  - [ ] 出勤状态选择
  - [ ] 缺席原因输入
  - [ ] 补课标记功能
  - [ ] 教师备注功能

#### 3.3 上课记录生成
- [ ] ActualLessonRecordController API
  - [ ] 基于点名生成上课记录
  - [ ] 课时消耗计算
  - [ ] 上课记录查询
  - [ ] 上课记录统计
- [ ] 上课记录前端界面
  - [ ] 记录列表展示
  - [ ] 记录详情查看
  - [ ] 记录编辑功能

### 阶段4：数据统计功能 (3-5天)

#### 4.1 出勤统计
- [ ] 出勤统计API
  - [ ] 学员个人出勤率
  - [ ] 班级出勤统计
  - [ ] 缺席原因分析
  - [ ] 出勤趋势分析
- [ ] 出勤统计前端界面
  - [ ] 统计图表展示
  - [ ] 数据筛选功能
  - [ ] 报表导出功能

#### 4.2 课时统计
- [ ] 课时统计API
  - [ ] 课时消耗统计
  - [ ] 剩余课时计算
  - [ ] 消耗趋势分析
  - [ ] 预计完课时间
- [ ] 课时统计前端界面
  - [ ] 课时使用图表
  - [ ] 进度条展示
  - [ ] 预测分析

#### 4.3 学习进度
- [ ] 学习进度API
  - [ ] 课程进度计算
  - [ ] 学习内容完成度
  - [ ] 学习效果评估
- [ ] 学习进度前端界面
  - [ ] 进度可视化
  - [ ] 学习路径展示
  - [ ] 成就展示

### 阶段5：家长端数据接口 (2-3天)

#### 5.1 家长端课程信息API
- [ ] 学员课程信息
  - [ ] 报名课程列表
  - [ ] 课程大纲信息
  - [ ] 学习进度展示
- [ ] 课程安排信息
  - [ ] 未来课程表
  - [ ] 上课时间安排
  - [ ] 授课教师信息

#### 5.2 家长端学习记录API
- [ ] 学习记录信息
  - [ ] 出勤记录查询
  - [ ] 课时消耗记录
  - [ ] 学习内容记录
  - [ ] 作业布置记录
- [ ] 学习统计信息
  - [ ] 出勤率统计
  - [ ] 学习进度统计
  - [ ] 预计完课时间

## 📅 开发时间安排

### 第1周 (8月19日-8月25日)
- **阶段1**: 数据库建设 (3-5天)
- **阶段2开始**: 时间段管理功能

### 第2周 (8月26日-9月1日)  
- **阶段2**: 排课功能开发 (5-7天)

### 第3周 (9月2日-9月8日)
- **阶段3**: 考勤功能开发 (5-7天)

### 第4周 (9月9日-9月15日)
- **阶段4**: 数据统计功能 (3-5天)
- **阶段5**: 家长端数据接口 (2-3天)

## 🎯 里程碑目标

### 里程碑1 (8月25日)
- ✅ 完成所有数据库表创建
- ✅ 完成时间段管理功能
- ✅ 完成基础排课功能

### 里程碑2 (9月1日)
- ✅ 完成一键排课功能
- ✅ 完成课程表查看功能
- ✅ 完成排课冲突检测

### 里程碑3 (9月8日)
- ✅ 完成点名签到功能
- ✅ 完成上课记录生成
- ✅ 完成考勤统计功能

### 里程碑4 (9月15日)
- ✅ 完成所有统计功能
- ✅ 完成家长端数据接口
- ✅ 系统整体测试通过

## 🔧 技术要点

### 数据库设计要点
- 合理的外键约束和索引设计
- 支持软删除和数据审计
- 考虑数据查询性能优化
- 预留扩展字段

### API设计要点
- RESTful API 设计规范
- 统一的响应格式
- 合理的分页和筛选
- 完善的错误处理

### 前端开发要点
- 组件化开发思路
- 响应式界面设计
- 用户体验优化
- 数据实时更新

### 性能优化要点
- 数据库查询优化
- 缓存策略设计
- 前端渲染优化
- 接口响应速度优化

## 📝 注意事项

1. **数据一致性**: 确保排课、点名、上课记录之间的数据一致性
2. **并发处理**: 考虑多用户同时操作的并发场景
3. **权限控制**: 严格的数据权限控制，确保数据安全
4. **用户体验**: 界面操作要简单直观，减少用户学习成本
5. **扩展性**: 为未来功能扩展预留接口和数据结构
6. **测试覆盖**: 关键业务逻辑要有完整的测试覆盖

## 🚀 下一步行动

**立即开始**: 阶段1 - 数据库建设
1. 创建 time_slots 表的迁移文件
2. 创建 class_schedules 表的迁移文件  
3. 创建相关模型文件
4. 准备基础种子数据

准备好开始了吗？我们从创建时间段配置表开始！
