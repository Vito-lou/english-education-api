# 数据库设计对比分析

## 📊 原系统 vs 我们的设计

### 1. 机构管理对比

#### 原系统设计：
- **表名**: 没有独立的机构表，使用`school_id`字段分散在各表中
- **问题**: 
  - 缺乏机构基础信息的统一管理
  - 无法支持机构的详细配置
  - 扩展性差

#### 我们的设计：
- **表名**: `institutions`
- **改进**:
  - ✅ 独立的机构表，完整的机构信息
  - ✅ 支持机构Logo、介绍、联系方式等
  - ✅ 营业执照、营业时间等业务信息
  - ✅ JSON配置字段，支持灵活扩展
  - ✅ 软删除和状态管理

### 2. 组织架构对比

#### 原系统设计：
```sql
wl_edu_structures (
  id, school_id, name, parent_id, type, sort, 
  created_at, updated_at, deleted_at
)
```

#### 我们的设计：
```sql
departments (
  id, institution_id, parent_id, name, code, type,
  description, manager_name, manager_phone, address,
  capacity, facilities, sort_order, status, ...
)
```

**改进点**:
- ✅ 增加部门代码，便于系统集成
- ✅ 增加负责人信息
- ✅ 支持教室容量和设施管理
- ✅ 更详细的类型分类（校区/部门/教室）
- ✅ 完善的状态管理

### 3. 用户管理对比

#### 原系统设计：
- **管理员**: `wl_edu_admin_users` (复杂的字段设计)
- **普通用户**: `wl_edu_users` (字段较少)
- **问题**: 
  - 管理员和普通用户分离，不利于统一管理
  - 权限设计复杂且不够灵活

#### 我们的设计：
- **统一用户表**: 扩展Laravel默认`users`表
- **改进**:
  - ✅ 统一的用户管理，通过角色区分权限
  - ✅ 完整的员工信息（工号、资质、擅长科目等）
  - ✅ 支持教师特殊属性（授课能力、课时费等）
  - ✅ 灵活的雇佣类型和状态管理

### 4. 角色权限对比

#### 原系统设计：
- 权限硬编码在代码中
- 角色功能相对固定

#### 我们的设计：
- **独立角色表**: `roles`
- **用户角色关联**: `user_roles`
- **改进**:
  - ✅ 动态权限配置，支持JSON存储
  - ✅ 数据权限和功能权限分离
  - ✅ 支持多角色分配
  - ✅ 系统预设角色 + 自定义角色

## 🎯 设计原则

### 1. 多租户支持
- 每个表都有`institution_id`，实现数据隔离
- 支持机构独立配置和管理

### 2. 扩展性
- 大量使用JSON字段存储配置信息
- 预留扩展字段，便于后续功能添加

### 3. 数据完整性
- 完善的外键约束
- 软删除支持，保证数据安全

### 4. 性能优化
- 合理的索引设计
- 状态字段便于快速查询

### 5. 业务适配
- 针对教培行业特点设计
- 支持教师、学员、家长等多种角色

## 📋 下一步计划

1. **创建Model和关联关系**
2. **实现基础的CRUD API**
3. **添加数据验证和权限控制**
4. **创建前端管理界面**
5. **编写单元测试**

## 🔄 迁移策略

如果需要从原系统迁移数据：

1. **机构数据**: 从各表的`school_id`提取机构信息
2. **组织架构**: 从`wl_edu_structures`迁移并补充字段
3. **用户数据**: 合并`wl_edu_admin_users`和`wl_edu_users`
4. **权限数据**: 重新设计和分配角色权限

这样的设计既保持了原系统的核心功能，又大大提升了系统的可维护性和扩展性。
